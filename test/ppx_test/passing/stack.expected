module type StackInterface  =
  sig
    type 'a t
    val empty : 'a t
    val push : 'a -> 'a t -> 'a t
    val pop : 'a t -> 'a t option
    val peek : 'a t -> 'a option
    val clear : 'a t -> unit
    val is_empty : 'a t -> bool
    val length : 'a t -> int
  end[@@deriving (mica_types, mica)]
include
  struct
    [@@@ocaml.warning "-60"]
    type expr =
      | Empty 
      | Push of int * expr 
      | Pop of expr 
      | Peek of expr 
      | Clear of expr 
      | Is_empty of expr 
      | Length of expr 
    type ty =
      | Bool 
      | Int 
      | IntOption 
      | IntT 
      | IntTOption 
      | Unit 
    let gen_expr ty =
      let open Core.Quickcheck.Generator in
        let open Let_syntax in size >>= (fun x -> return x)
    module TestHarness(M:StackInterface) =
      struct
        include M
        type value =
          | ValBool of bool 
          | ValInt of int 
          | ValIntOption of int option 
          | ValIntT of int t 
          | ValIntTOption of int t option 
          | ValUnit of unit 
        let rec interp e =
          match e with
          | Empty -> ValIntT M.empty
          | Push (int__001_, expr__002_) ->
              (match interp expr__002_ with
               | ValIntT expr__002_' ->
                   ValIntT (M.push int__001_ expr__002_')
               | _ -> failwith "impossible: n-ary constructor")
          | Pop expr__003_ ->
              (match interp expr__003_ with
               | ValIntT expr__003_' -> ValIntTOption (M.pop expr__003_')
               | _ -> failwith "impossible: unary constructor")
          | Peek expr__004_ ->
              (match interp expr__004_ with
               | ValIntT expr__004_' -> ValIntOption (M.peek expr__004_')
               | _ -> failwith "impossible: unary constructor")
          | Clear expr__005_ ->
              (match interp expr__005_ with
               | ValIntT expr__005_' -> ValUnit (M.clear expr__005_')
               | _ -> failwith "impossible: unary constructor")
          | Is_empty expr__006_ ->
              (match interp expr__006_ with
               | ValIntT expr__006_' -> ValBool (M.is_empty expr__006_')
               | _ -> failwith "impossible: unary constructor")
          | Length expr__007_ ->
              (match interp expr__007_ with
               | ValIntT expr__007_' -> ValInt (M.length expr__007_')
               | _ -> failwith "impossible: unary constructor")
      end
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
